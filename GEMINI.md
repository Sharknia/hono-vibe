## 1. 개발 원칙 (Gemini-CLI 준수 사항)

**이 프로젝트는 아래 원칙을 반드시 따릅니다.**

0.  **읽기 우선 원칙 (Read-First Principle) 및 신중한 도구 사용:**
    -   **추측 금지:** 파일 수정/삭제 등 모든 파일 시스템 작업 전, **반드시 `read_file`을 통해 대상 파일의 최신 내용을 먼저 읽고 확인**한다. 추측에 기반한 작업을 엄금한다.
    -   **실패 시 정지 및 분석:** 도구 사용 실패 시, 다른 도구를 섣불리 시도하지 않고 즉시 작업을 멈춘다. `read_file`과 `ls` 등을 통해 현상을 명확히 파악하고, 원인을 분석한 뒤 다음 계획을 신중하게 수립한다.

1.  **엄격한 DDD(Domain-Driven Design) 준수:**

    -   각 계층(Presentation, Application, Domain, Infrastructure)의 역할을 명확히 분리하고, 의존성 방향을 엄격히 지킵니다.
    -   도메인 로직은 Domain 계층에만 존재해야 하며, 다른 계층은 이를 오염시키지 않습니다.

2.  **엄격한 TDD(Test-Driven Development):**

    -   새로운 기능을 추가하거나 버그를 수정할 때는 항상 실패하는 테스트를 먼저 작성하고, 이를 통과시키는 코드를 작성합니다.
    -   모든 비즈니스 로직과 주요 경로는 반드시 테스트 코드로 커버되어야 합니다.

3.  **꼼수 금지 (No Workarounds & Hacks):**

    -   임시방편적인 해결책이나 "나중에 수정할" 주석을 남기지 않습니다.
    -   문제의 근본 원인을 파악하고, 아키텍처 원칙에 맞는 올바른 해결책을 적용합니다.

4.  **DB 환경 분리 원칙:**

    -   **자동화 테스트 (`vitest`):** 속도와 격리를 위해 **인메모리 SQLite (`better-sqlite3`)**를 사용합니다.
    -   **로컬 개발 (`wrangler dev`):** 프로��션 환경과 동일한 경험을 위해 **Cloudflare D1의 로컬 에뮬레이션**을 사용합니다.
    -   **마이그레이션 (`drizzle-kit`):** `npx drizzle-kit generate` 실행 시, `.dev.vars`에 설정된 Cloudflare API/DB 정보를 사용하여 D1 스키마와 동기화된 마이그레이션 파일을 생성합니다.

5.  **Git 워크플로우 준수:**

    -   각 주요 단계(Stage)가 완료되고 모든 테스트가 통과하면, 변경사항을 `dev` 브랜치에 커밋하고 푸시합니다.
    -   커밋 메시지는 명확하고 일관된 스타일을 유지합니다.

6.  **지속적인 진행 상황 체크 및 문서 최신화:**

    -   `GEMINI_GUIDE.md`의 체크리스트를 꾸준히 업데이트하여 현재 진행 상황을 명확히 파악합니다.
    -   변경 사항이 발생하면 관련 문서(`README.md` 등)도 함께 업데이트합니다.
    -   src/index.ts를 참조해 api 추가 시 반드시 문서를 업데이트 합니다.

7.  **콘텐츠 변경 시 주의:**

    -   파일 수정 시, 특히 Gemini-CLI를 사용할 때, 기존 내용이 의도치 않게 생략되거나 삭제되지 않도록 주의한다. 변경 전후 내용을 반드시 확인하고, Git을 통해 작업 내용을 안전하게 관리한다.

8.  **Task 실행 워크플로우 (엄격 준수)**
    -   작업 지시를 받으면, 가장 먼저 `epics/` 폴더에 `yyyyMMddHHmm_작업명.md` 형식으로 Epic 파일을 생성한다.
    -   Epic 파일에는 Task와 상세 Subtask 체크리스트를 작성한다.
    -   개발은 Subtask 단위로 진행하며, 다음 절차를 **반드시** 따른다:
        1.  **Subtask 선택:** 현재 진행할 Subtask를 명확히 인지한다.
        2.  **실패하는 테스트 작성 (TDD):** Subtask에 해당하는 실패하는 테스트 코드를 먼저 작성한다.
        3.  **코드 구현:** 테스트를 통과시키는 최소한의 코드를 작성한다.
        4.  **전체 테스트 실행:** `npm test`를 실행하여 모든 테스트가 통과하는지 확인한다. (회귀 테스트)
        5.  **Epic 파일 업데이트:** 테스트 통과 확인 후, `epics/` 파일의 해당 Subtask를 체크(`[x]`)한다.
        6.  **커밋:** `git commit`을 통해 변경 사항을 `dev` 브랜치에 커밋한다. 커밋 메시지는 완료된 Task를 명시한다.
        7.  **반복:** 다음 Subtask에 대해 위 과정을 반복한다.

---
